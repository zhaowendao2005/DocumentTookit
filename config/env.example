###############################################
# 示例环境配置（env.yaml.example）
#
# 使用说明（傻瓜式）：
# 1) 复制本文件为 config/env.yaml，然后按需修改。
# 2) 程序启动时会自动把本文件复制为 config/env.example，
#    仅用于参考，不会被程序读取。
# 3) 真实生效的配置文件始终是 config/env.yaml。
###############################################

# LLM提供商配置（示例：OpenAI 官方 API）
providers:
  - name: "OpenAI"
    base_url: "https://api.openai.com"    # 注意：无需带 /v1，程序会自动追加
    api_key: "YOUR_OPENAI_API_KEY"        # 示例占位，不要提交真实密钥
    models:
      - "gpt-4o-mini"
      - "gpt-4o"


# 统一路径管理器配置
# - root_path: 允许访问的最高根目录（建议使用项目根目录或绝对路径）
# - security: 路径安全限制
# - default_paths / bookmarks: UI 的默认路径与快捷入口
path_manager:
  root_path: "."                          # 以程序启动目录为根
  security:
    allow_dangerous_paths: false
    blocked_patterns: ["node_modules", ".git", "*.exe", "*.bat"]
  default_paths:
    batch_input: "./data/input"
    batch_output: "./data/output"
    docx_input: "./data/input"
    docx_output: "./data/output"
    csv_input: "./data/output"
    csv_output: "./data/merged"
    text_splitter_input: "./data/input"
    text_splitter_output: "./data/output/split_results"
    temp: "./data/temp"
    logs: "./data/logs"
    sourcefiles: "./sourcefiles"
  bookmarks:
    "输入目录": "./data/input"
    "输出目录": "./data/output"
    "合并目录": "./data/merged"
    "源文件": "./sourcefiles"
    "临时目录": "./data/temp"
    "日志目录": "./data/logs"
    "项目根目录": "./"


# 兼容性：保留原有目录配置
directories:
  input_dir: "./data/input"
  output_dir: "./data/output"
  temp_dir: "./data/temp"
  candidate_tools_dir: "./sourcefiles"


# 处理模式配置
processing:
  default_mode: "structured"           # classic | structured
  allow_fallback: true                  # 结构化失败是否回退经典
  fallback_mode: "classic"             # 失败回退目标


# 结构化模式配置
structured:
  prompts_root: "./prompts/StructuredFileProcessor"
  default_prompt_version: "Version1"
  max_repair_attempts: 2                # JSON纠错回合上限（0-3）
  force_json_response: false            # 若provider支持，可强制json模式（保留为false）
  schema_path: "./schemas/rows.schema.json"  # 作为后备；优先使用版本内 rows.schema.json


# 并发控制
concurrency:
  max_concurrent_requests: 100          # 与当前配置对齐；若API限流可调小


# 校验配置
validation:
  enable_multiple_requests: true
  request_count: 3
  similarity_threshold: 0.8


# 自动重试配置
retry:
  enable_auto_retry: true
  max_retry_count: 3
  retry_delay_ms: 1000
  retry_on_errors:
    - "rate_limit_exceeded"
    - "server_error"
    - "timeout"
    - "network_error"


# Token统计配置
token_tracking:
  enable_token_counting: true
  show_detailed_stats: true
  save_token_logs: true
  log_file: "./data/logs/token_usage.log"


# 系统提示词文件路径（classic模式使用）
system_prompt_file: "./prompts/Prompt.txt"


# 网络超时配置
network:
  connect_timeout_ms: 3000
  response_timeout_ms: 60000


# 文本分割工具配置
text_splitter:
  default_source_file: "./data/input/source.txt"
  default_output_dir: "./data/output/split_results"
  default_file_extension: ".txt"
  include_metadata: true
  flatten_structure: false


# Docx转Markdown工具配置
docx_converter:
  default_input_dir: "./data/input"
  default_output_dir: "./data/output"
  default_file_extension: ".md"


# CSV合并工具配置
csv_merger:
  default_input_dir: "./data/output"
  default_output_dir: "./data/merged"
  default_output_prefix: "merged"


# 模型测试工具配置
model_tester:
  default_test_prompt: "请简单回复'测试成功'"
  default_response_timeout: 60
  default_connect_timeout: 3000
